<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>الأجهزة - HR Dashboard</title>
    
    <!-- /* ================= START Favicons, Fonts, Libraries ================= */ -->
    <link rel="icon" href="../assets/images/LOGO.png"  />
    <link href="../assets/bootstrap/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="../assets/CSS/all.min.css">
    <link href="https://cdn.jsdelivr.net/npm/aos@2.3.4/dist/aos.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Almarai:wght@400;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css">
    
    <!-- /* ================= START Custom CSS ================= */ -->
    <link rel="stylesheet" href="../assets/CSS/style.css">
    <link rel="stylesheet" href="../assets/CSS/devices.css">
</head>
<body>
   <!-- Backdrop & Sidebars -->
   <div class="sidebar-backdrop"></div>
   <div class="dashboard-container">
   <!-- /* ================= START Mini Sidebar ================= */ -->
   <aside class="mini-sidebar">
    <a href="../index.html" class="mini-logo active">
      <img src="../assets/images/HRlogo.png" alt="Logo" />
    </a>
    
    <ul class="mini-nav">
      <li>
        <a href="#" id="open-search" title="بحث">
          <i class="fas fa-search"></i>
        </a>
      </li>
              <li><a href="https://spl-pro.com/calender/public/login" title="التقويم"><i class="fas fa-calendar-alt"></i></a></li>
      <li>
        <a href="tel:+966561666795" title="اتصل بنا">
          <i class="fas fa-address-book"></i>
        </a>
      </li>        <li>
        <a href="mailto:info@spl-pro.com" title="الرسائل">
          <i class="fas fa-comment-dots"></i>
        </a>
      </li>
              <li><a href="#" title="الملفات"><i class="fas fa-folder"></i></a></li>
    </ul>
    <div class="mini-sidebar-footer">
              <!-- زرار التوجل -->
      <div class="mini-sidebar-toggle">
          <button id="toggleMainSidebar" class="toggle-btn">
          <i class="fas fa-angle-double-left"></i>
          </button>
      </div>
      <a href="../pages/settings.html" title="الإعدادات"><i class="fas fa-cog p-3"></i></a>
      <a href="#" title="ملف شخصي">
        <img src="../assets/images/profile.jpg" alt="User" class="mini-profile-img" />
      </a>
      
    </div>
  </aside>
     
     <aside class="main-sidebar">
       <div class="sidebar-header"><h2 class="logoName">HRZoon</h2></div>
       <div class="sidebar-profile"><h3>أحمد هارون</h3><h4>المدير العام</h4></div>
       <nav class="sidebar-nav">
         <ul class="nav-list">
           <li class="nav-item"><a href="../index.html"><i class="fas fa-tachometer-alt"></i><span>الرئيسية</span></a></li>
           <li class="nav-item has-submenu open active">
             <a href="#"><i class="fas fa-cogs"></i><span>الإعدادات</span><i class="fas fa-chevron-left arrow"></i></a>
             <ul class="submenu" style="max-height: 500px;">
               <li><a href="./settings.html">إعدادات عامة</a></li>
               <li><a href="./subscriptions.html">الاشتراكات</a></li>
               <li class="active"><a href="./devices.html">الأجهزة</a></li>
             </ul>
           </li>
           <!-- ... (باقي عناصر القائمة ) ... -->
         </ul>
       </nav>
     </aside>

    <!-- /* ================= START Main Content ================= */ -->
    <main class="main-content">
      <header class="main-header">
        <div class="header-left"><button id="sidebarToggle" class="header-icon mobile-menu-btn"><i class="fas fa-bars"></i></button><div class="header-title">الأجهزة</div></div>
        <div class="header-right">
            <div class="header-search"><i class="fas fa-search"></i><input type="text" placeholder="بحث..." /></div>
            <button class="header-icon"><i class="fas fa-bell"></i><span class="icon-badge">3</span></button>
            <button class="header-icon"><i class="fas fa-user-circle"></i></button>
        </div>
      </header>

      <div class="devices-container" data-aos="fade-up">
          <!-- الحالة الفارغة (تظهر عند عدم وجود أجهزة) -->
          <div id="empty-state" class="empty-state">
              <div class="empty-state-icon">
                  <svg width="120" height="120" viewBox="0 0 100 100" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path d="M75 35H25C23.8954 35 23 35.8954 23 37V85C23 86.1046 23.8954 87 25 87H75C76.1046 87 77 86.1046 77 85V37C77 35.8954 76.1046 35 75 35Z" stroke="#333" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/>
                      <path d="M60 25H40C38.8954 25 38 25.8954 38 27V35H62V27C62 25.8954 61.1046 25 60 25Z" stroke="#333" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/>
                      <path d="M30 42H50V50H30V42Z" fill="#fff" stroke="#333" stroke-width="2.5"/>
                      <path d="M58 55C58 52.7909 59.7909 51 62 51C64.2091 51 66 52.7909 66 55C66 56.5 65.5 58.5 64 60L62 62L60 60C58.5 58.5 58 56.5 58 55Z" stroke="#333" stroke-width="3"/>
                  </svg>                        
              </div>
              <p class="empty-state-message">لا توجد اجهزة بصمة مقترنة بالنظام حالياً</p>
              <button class="btn-add-device" id="add-device-empty-btn"><i class="fas fa-plus"></i>اضافة جهاز جديد</button>
          </div>


      </div>
    </main>
  </div>

  <!-- MODAL for Add/Edit Device -->
  <div class="modal-overlay hidden" id="device-modal">
      <div class="modal-card" data-aos="zoom-in-up">
          <button class="modal-close-btn">&times;</button>
          <h3 class="modal-title">إضافة جهاز جديد</h3>
          <form id="device-form">
              <div class="form-group"><label for="device-name">اسم الجهاز</label><input type="text" id="device-name" class="form-control" required></div>
              <div class="form-group"><label for="device-serial">الرقم التسلسلي (Serial)</label><input type="text" id="device-serial" class="form-control" required></div>
              <div class="form-group"><label for="device-location">الموقع</label><select id="device-location" class="form-control"><option>المكتب الرئيسي</option><option>فرع جدة</option></select></div>
              <div class="form-actions"><button type="submit" class="btn-primary">حفظ الجهاز</button></div>
          </form>
      </div>
  </div>

  <!-- /* ================= START Scripts ================= */ -->
  <script src="../assets/bootstrap/bootstrap.bundle.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/aos@2.3.4/dist/aos.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <script src="../assets/JS/devices.js"></script>
  <script src="../assets/JS/script.js"></script>
  
  <script>
    document.addEventListener('DOMContentLoaded', function ( ) {
        AOS.init({ duration: 600, once: true });

        let devicesData = [];

        const emptyState = document.getElementById('empty-state');
        const listContainer = document.getElementById('devices-list-container');
        const devicesGrid = document.getElementById('devices-grid');
        const modal = document.getElementById('device-modal');
        const addDeviceEmptyBtn = document.getElementById('add-device-empty-btn');
        const addDeviceListBtn = document.getElementById('add-device-list-btn');
        const closeModalBtn = modal.querySelector('.modal-close-btn');
        const deviceForm = document.getElementById('device-form');

        function updateViewState() {
            if (devicesData.length === 0) {
                emptyState.classList.remove('hidden');
                listContainer.classList.add('hidden');
            } else {
                emptyState.classList.add('hidden');
                listContainer.classList.remove('hidden');
                renderDevices();
            }
        }

        function renderDevices() {
            devicesGrid.innerHTML = '';
            devicesData.forEach(device => {
                const deviceCard = `
                    <div class="device-card" data-id="${device.id}">
                        <div class="device-icon"><i class="fas fa-fingerprint"></i></div>
                        <div class="device-info">
                            <span class="device-name">${device.name}</span>
                            <span class="device-serial">S/N: ${device.serial}</span>
                        </div>
                        <div class="device-actions">
                            <button class="action-btn delete-btn"><i class="fas fa-trash-alt"></i></button>
                        </div>
                    </div>
                `;
                devicesGrid.insertAdjacentHTML('beforeend', deviceCard);
            });
        }

        const openModal = () => modal.classList.remove('hidden');
        const closeModal = () => modal.classList.add('hidden');

        addDeviceEmptyBtn.addEventListener('click', openModal);
        addDeviceListBtn.addEventListener('click', openModal);
        closeModalBtn.addEventListener('click', closeModal);
        modal.addEventListener('click', (e) => { if (e.target === modal) closeModal(); });

        deviceForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const newDevice = {
                id: Date.now(),
                name: document.getElementById('device-name').value,
                serial: document.getElementById('device-serial').value,
                location: document.getElementById('device-location').value
            };
            devicesData.push(newDevice);
            deviceForm.reset();
            closeModal();
            updateViewState();
            Swal.fire('تم!', 'تمت إضافة الجهاز بنجاح.', 'success');
        });

        devicesGrid.addEventListener('click', (e) => {
            if (e.target.closest('.delete-btn')) {
                const card = e.target.closest('.device-card');
                const deviceId = parseInt(card.dataset.id, 10);
                Swal.fire({
                    title: 'هل أنت متأكد؟', text: "سيتم حذف الجهاز نهائياً!", icon: 'warning',
                    showCancelButton: true, confirmButtonColor: '#dc3545', cancelButtonText: 'إلغاء', confirmButtonText: 'نعم، احذفه!'
                }).then((result) => {
                    if (result.isConfirmed) {
                        devicesData = devicesData.filter(d => d.id !== deviceId);
                        updateViewState();
                        Swal.fire('تم الحذف!', 'تم حذف الجهاز بنجاح.', 'success');
                    }
                });
            }
        });

        updateViewState();
    });
  </script>
</body>
</html>
